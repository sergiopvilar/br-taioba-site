var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();if(!customElements.get("price-per-item")){customElements.define("price-per-item",function(_super){__extends(PricePerItem,_super);function PricePerItem(){var _this=_super.call(this)||this;_this.updatePricePerItemUnsubscriber=undefined;_this.variantIdChangedUnsubscriber=undefined;_this.variantId=_this.dataset.variantId;_this.input=document.getElementById("Quantity-".concat(_this.dataset.sectionId||_this.dataset.variantId));if(_this.input){_this.input.addEventListener("change",_this.onInputChange.bind(_this))}_this.getVolumePricingArray();return _this}PricePerItem.prototype.connectedCallback=function(){var _this=this;this.variantIdChangedUnsubscriber=subscribe(PUB_SUB_EVENTS.variantChange,function(event){_this.variantId=event.data.variant.id.toString();_this.getVolumePricingArray()});this.updatePricePerItemUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,function(response){if(!response.cartData)return;if(response.cartData["variant_id"]!==undefined){if(response.productVariantId===_this.variantId)_this.updatePricePerItem(response.cartData.quantity)}else if(response.cartData.item_count!==0){var isVariant=response.cartData.items.find(function(item){return item.variant_id.toString()===_this.variantId});if(isVariant&&isVariant.id.toString()===_this.variantId){_this.updatePricePerItem(isVariant.quantity)}else{_this.updatePricePerItem(0)}}else{_this.updatePricePerItem(0)}})};PricePerItem.prototype.disconnectedCallback=function(){if(this.updatePricePerItemUnsubscriber){this.updatePricePerItemUnsubscriber()}if(this.variantIdChangedUnsubscriber){this.variantIdChangedUnsubscriber()}};PricePerItem.prototype.onInputChange=function(){this.updatePricePerItem()};PricePerItem.prototype.updatePricePerItem=function(updatedCartQuantity){if(this.input){this.enteredQty=parseInt(this.input.value);this.step=parseInt(this.input.step)}this.currentQtyForVolumePricing=updatedCartQuantity===undefined?this.getCartQuantity(updatedCartQuantity)+this.enteredQty:this.getCartQuantity(updatedCartQuantity)+parseInt(this.step);if(this.classList.contains("variant-item__price-per-item")){this.currentQtyForVolumePricing=this.getCartQuantity(updatedCartQuantity)}for(var _i=0,_a=this.qtyPricePairs;_i<_a.length;_i++){var pair=_a[_i];if(this.currentQtyForVolumePricing>=pair[0]){var pricePerItemCurrent=document.querySelector('price-per-item[id^="Price-Per-Item-'.concat(this.dataset.sectionId||this.dataset.variantId,'"] .price-per-item span'));this.classList.contains("variant-item__price-per-item")?pricePerItemCurrent.innerHTML=window.quickOrderListStrings.each.replace("[money]",pair[1]):pricePerItemCurrent.innerHTML=pair[1];break}}};PricePerItem.prototype.getCartQuantity=function(updatedCartQuantity){return updatedCartQuantity||updatedCartQuantity===0?updatedCartQuantity:parseInt(this.input.dataset.cartQuantity)};PricePerItem.prototype.getVolumePricingArray=function(){var _this=this;var volumePricing=document.getElementById("Volume-".concat(this.dataset.sectionId||this.dataset.variantId));this.qtyPricePairs=[];if(volumePricing){volumePricing.querySelectorAll("li").forEach(function(li){var qty=parseInt(li.querySelector("span:first-child").textContent);var price=li.querySelector("span:not(:first-child):last-child").dataset.text;_this.qtyPricePairs.push([qty,price])})}this.qtyPricePairs.reverse()};return PricePerItem}(HTMLElement))}
