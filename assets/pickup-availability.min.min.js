var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();if(!customElements.get("pickup-availability")){customElements.define("pickup-availability",function(_super){__extends(PickupAvailability,_super);function PickupAvailability(){var _this=_super.call(this)||this;if(!_this.hasAttribute("available"))return _this;_this.errorHtml=_this.querySelector("template").content.firstElementChild.cloneNode(true);_this.onClickRefreshList=_this.onClickRefreshList.bind(_this);_this.fetchAvailability(_this.dataset.variantId);return _this}PickupAvailability.prototype.fetchAvailability=function(variantId){var _this=this;var rootUrl=this.dataset.rootUrl;if(!rootUrl.endsWith("/")){rootUrl=rootUrl+"/"}var variantSectionUrl="".concat(rootUrl,"variants/").concat(variantId,"/?section_id=pickup-availability");fetch(variantSectionUrl).then(function(response){return response.text()}).then(function(text){var sectionInnerHTML=(new DOMParser).parseFromString(text,"text/html").querySelector(".shopify-section");_this.renderPreview(sectionInnerHTML)}).catch(function(e){var button=_this.querySelector("button");if(button)button.removeEventListener("click",_this.onClickRefreshList);_this.renderError()})};PickupAvailability.prototype.onClickRefreshList=function(evt){this.fetchAvailability(this.dataset.variantId)};PickupAvailability.prototype.renderError=function(){this.innerHTML="";this.appendChild(this.errorHtml);this.querySelector("button").addEventListener("click",this.onClickRefreshList)};PickupAvailability.prototype.renderPreview=function(sectionInnerHTML){var drawer=document.querySelector("pickup-availability-drawer");if(drawer)drawer.remove();if(!sectionInnerHTML.querySelector("pickup-availability-preview")){this.innerHTML="";this.removeAttribute("available");return}this.innerHTML=sectionInnerHTML.querySelector("pickup-availability-preview").outerHTML;this.setAttribute("available","");document.body.appendChild(sectionInnerHTML.querySelector("pickup-availability-drawer"));var colorClassesToApply=this.dataset.productPageColorScheme.split(" ");colorClassesToApply.forEach(function(colorClass){document.querySelector("pickup-availability-drawer").classList.add(colorClass)});var button=this.querySelector("button");if(button)button.addEventListener("click",function(evt){document.querySelector("pickup-availability-drawer").show(evt.target)})};return PickupAvailability}(HTMLElement))}if(!customElements.get("pickup-availability-drawer")){customElements.define("pickup-availability-drawer",function(_super){__extends(PickupAvailabilityDrawer,_super);function PickupAvailabilityDrawer(){var _this=_super.call(this)||this;_this.onBodyClick=_this.handleBodyClick.bind(_this);_this.querySelector("button").addEventListener("click",function(){_this.hide()});_this.addEventListener("keyup",function(event){if(event.code.toUpperCase()==="ESCAPE")_this.hide()});return _this}PickupAvailabilityDrawer.prototype.handleBodyClick=function(evt){var target=evt.target;if(target!=this&&!target.closest("pickup-availability-drawer")&&target.id!="ShowPickupAvailabilityDrawer"){this.hide()}};PickupAvailabilityDrawer.prototype.hide=function(){this.removeAttribute("open");document.body.removeEventListener("click",this.onBodyClick);document.body.classList.remove("overflow-hidden");removeTrapFocus(this.focusElement)};PickupAvailabilityDrawer.prototype.show=function(focusElement){this.focusElement=focusElement;this.setAttribute("open","");document.body.addEventListener("click",this.onBodyClick);document.body.classList.add("overflow-hidden");trapFocus(this)};return PickupAvailabilityDrawer}(HTMLElement))}
